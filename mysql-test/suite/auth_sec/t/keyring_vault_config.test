--disable_ps_protocol
--disable_warnings
--source include/not_embedded.inc

call mtr.add_suppression("keyring_file_data cannot be set to new value as the keyring file cannot be created/accessed in the provided path");
call mtr.add_suppression("Error while loading keyring content. The keyring might be malformed");
call mtr.add_suppression("\\[ERROR\\] Plugin keyring_file reported: 'File .*/keyring' not found .*");
call mtr.add_suppression("\\[ERROR\\] Plugin keyring_file reported: 'File .*/bad_keyring_file_data/' not found .*");
call mtr.add_suppression("\\[ERROR\\] Plugin keyring_vault reported: 'Could not open file with credentials.'");

--replace_result $MYSQL_TMP_DIR MYSQL_TMP_DIR
SELECT @@global.keyring_vault_config;
--replace_result $MYSQL_TMP_DIR MYSQL_TMP_DIR
eval SET @@global.keyring_vault_config= '/home/rob/vault/keyring_vault2.conf';
--replace_result $MYSQL_TMP_DIR MYSQL_TMP_DIR
SELECT @@global.keyring_vault_config;
--Error ER_WRONG_VALUE_FOR_VAR
SET @@global.keyring_vault_config= '../../../../../bad_dir/bad_keyring_vault.conf';
--Error ER_WRONG_VALUE_FOR_VAR
SET @@global.keyring_vault_config=NULL;
--replace_result $MYSQL_TMP_DIR MYSQL_TMP_DIR
SELECT @@global.keyring_vault_config;

# cleanup
--replace_result $MYSQL_TMP_DIR MYSQL_TMP_DIR
eval SET @@global.keyring_vault_config= '/home/rob/vault/keyring_vault.conf';
