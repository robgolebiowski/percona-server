SET GLOBAL innodb_encrypt_tables = ONLINE_TO_KEYRING;
SET GLOBAL innodb_encryption_threads = 4;
CREATE TABLE t1 (pk INT PRIMARY KEY AUTO_INCREMENT, c VARCHAR(256)) ENGINE=INNODB encryption='N' ENCRYPTION_KEY_ID=4;
ERROR HY000: InnoDB: ENCRYPTION_KEY_ID cannot be assigned to tables that have encryption explcitily disabled ENCRYPTION='N'. If you want to assign ENCRYPTION_KEY_ID to this table change its encryption type explicitly to 'KEYRING'
CREATE TABLE t1 (pk INT PRIMARY KEY AUTO_INCREMENT, c VARCHAR(256)) ENGINE=INNODB;
DROP TABLE t1;
CREATE TABLE t1 (pk INT PRIMARY KEY AUTO_INCREMENT, c VARCHAR(256)) ENGINE=INNODB encryption='KEYRING';
DROP TABLE t1;
set innodb_default_encryption_key_id = 4;
CREATE TABLE t1 (pk INT PRIMARY KEY AUTO_INCREMENT, c VARCHAR(256)) ENGINE=INNODB encryption='KEYRING';
SHOW CREATE TABLE t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `pk` int(11) NOT NULL AUTO_INCREMENT,
  `c` varchar(256) DEFAULT NULL,
  PRIMARY KEY (`pk`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1 ENCRYPTION='KEYRING' ENCRYPTION_KEY_ID=4
DROP TABLE t1;
CREATE TABLE t1 (pk INT PRIMARY KEY AUTO_INCREMENT, c VARCHAR(256)) ENGINE=INNODB;
SHOW CREATE TABLE t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `pk` int(11) NOT NULL AUTO_INCREMENT,
  `c` varchar(256) DEFAULT NULL,
  PRIMARY KEY (`pk`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1 ENCRYPTION_KEY_ID=4
CREATE TABLE t2 (pk INT PRIMARY KEY AUTO_INCREMENT, c VARCHAR(256)) ENGINE=INNODB encryption='N' ENCRYPTION_KEY_ID=1;
ERROR HY000: InnoDB: ENCRYPTION_KEY_ID cannot be assigned to tables that have encryption explcitily disabled ENCRYPTION='N'. If you want to assign ENCRYPTION_KEY_ID to this table change its encryption type explicitly to 'KEYRING'
CREATE TABLE t2 (pk INT PRIMARY KEY AUTO_INCREMENT, c VARCHAR(256)) ENGINE=INNODB encryption='N';
ALTER TABLE t1 ENCRYPTION_KEY_ID=99;
SHOW WARNINGS;
Level	Code	Message
set innodb_default_encryption_key_id = 1;
drop table t1,t2;
